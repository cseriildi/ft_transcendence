name: transcendence

services:
  databank:
    build:
      context: ./backend_database
    container_name: database
    volumes:
      - ./backend_database/database:/app/data
    restart: unless-stopped
    networks:
      - transcendence

  backend:
    build:
      context: ./backend_gamelogic
    container_name: game
    # env_file:
    #   - ./backend_gamelogic/.env.game
    restart: unless-stopped
    networks:
      - transcendence

  frontend:
    build:
      context: ./frontend
    container_name: frontend
    restart: unless-stopped
    networks:
      - transcendence

  nginx:
    image: nginx:alpine
    container_name: nginx-proxy
    ports:
      - "8443:8443"
    volumes:
      - ./ops/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./.certs:/etc/nginx/certs:ro
    depends_on:
      - frontend
      - databank
      - backend
    restart: unless-stopped
    networks:
      - transcendence

  live-chat:
    build:
      context: ./live-chat
    container_name: live-chat
    ports:
      - "3002:3002"
    depends_on:
      - databank
    restart: unless-stopped
    networks:
      - transcendence

volumes:
  databank-data:

networks:
  transcendence:
    driver: bridge
