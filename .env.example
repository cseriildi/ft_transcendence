# =============================================================================
# ARCHITECTURE OVERVIEW
# =============================================================================
# This application uses a microservices architecture with NGINX as a reverse proxy:
#
# Browser --> NGINX:8443 (TLS/SSL) --> Internal Services
#              ├─ /         --> frontend:4200
#              ├─ /api/     --> databank:3000
#              ├─ /auth/    --> databank:3000
#              ├─ /oauth/   --> databank:3000
#              ├─ /game/    --> backend:3001
#              └─ /ws/game  --> backend:3001 (WebSocket)
#
# All internal service ports are ONLY accessible within the Docker network.
# External access is ONLY through NGINX on the configured NGINX_PORT.
#
# =============================================================================
# ENVIRONMENT FILE USAGE
# =============================================================================
# This file (.env.example) contains Docker Compose / Production defaults.
# Copy it to .env to run the full stack: cp .env.example .env && make
#
# For local development or dev containers, see .env.development instead.
# It has localhost-friendly defaults for running services individually.
#
# =============================================================================
# Global Application Configuration
# =============================================================================
APP_NAME=ft_transcendence
NODE_ENV=production

# =============================================================================
# Public-Facing URL Configuration
# =============================================================================
# These are used for OAuth callbacks, CORS origins, and WebSocket URLs
# For local development with NGINX proxy:
PUBLIC_HOST=localhost
PUBLIC_PORT=8443
PUBLIC_PROTOCOL=https

# CORS allowed origins (comma-separated list)
CORS_ORIGINS=https://localhost:8443,http://localhost:4200

# =============================================================================
# NGINX Reverse Proxy (Public Gateway)
# =============================================================================
# HTTPS port (443 for production, 8443 for school PCs)
NGINX_HTTPS_PORT=8443
# HTTP port - redirects to HTTPS (80 for production, 8080 for school PCs)
NGINX_HTTP_PORT=8080
NGINX_HOST=localhost

# Public URLs (what the browser uses to connect)
# These should match your NGINX_HTTPS_PORT
PUBLIC_API_URL=https://localhost:8443
PUBLIC_WS_URL=wss://localhost:8443/ws

# =============================================================================
# Frontend Service (Internal)
# =============================================================================
# Internal port - only accessible within Docker network
FRONTEND_PORT=4200

# =============================================================================
# Backend Database Service (databank - Internal)
# =============================================================================
DATABANK_PORT=3000
DATABANK_HOST=0.0.0.0
# Database path inside Docker container (for local dev: ./src/database/database.db)
DATABANK_DATABASE_PATH=/app/data/database.db

# Route prefixes (all API routes are under /api)
AUTH_PREFIX=/api/auth
OAUTH_PREFIX=/api/oauth
API_PREFIX=/api

# JWT Configuration
JWT_ISSUER=ping-pong-api
JWT_AUDIENCE=ping-pong-clients
JWT_ACCESS_SECRET=dev-access-secret-change-me
JWT_REFRESH_SECRET=dev-refresh-secret-change-me
JWT_ACCESS_TTL=15m
JWT_REFRESH_TTL=7d

# OAuth Configuration
OAUTH_STATE_SECRET=dev-oauth-state-secret-change-me
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
# Leave empty to auto-generate based on PUBLIC_HOST/PUBLIC_PORT/PUBLIC_PROTOCOL
GITHUB_REDIRECT_URI=
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
# Leave empty to auto-generate based on PUBLIC_HOST/PUBLIC_PORT/PUBLIC_PROTOCOL
GOOGLE_REDIRECT_URI=

# =============================================================================
# Game Logic Service (backend)
# =============================================================================
GAMELOGIC_PORT=3001
GAMELOGIC_HOST=0.0.0.0

# Game Settings
GAME_WIDTH=3200
GAME_HEIGHT=2000
MAX_SCORE=10
BALL_RADIUS=40
BALL_SPEED=35
PADDLE_SPEED=40
PHYSICS_FPS=60
RENDER_FPS=30

# =============================================================================
# Live Chat Service
# =============================================================================
LIVECHAT_PORT=3002
LIVECHAT_HOST=0.0.0.0
# Database path inside Docker container (for local dev: ./src/database/database.db)
LIVECHAT_DATABASE_PATH=/app/data/database.db
AUTH_SERVICE_URL=http://databank:3000

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=info

# =============================================================================
# ELK Stack - Log Management (Optional)
# =============================================================================
# Enable security features (basic auth) for production
ELK_SECURITY_ENABLED=false

# Elasticsearch
ELASTICSEARCH_PORT=9200
ELASTIC_USERNAME=elastic
ELASTIC_PASSWORD=changeme

# Logstash
LOGSTASH_PORT=5044
LOGSTASH_TCP_PORT=5000
LOGSTASH_UDP_PORT=5000

# Kibana
KIBANA_PORT=5601
KIBANA_PUBLIC_URL=http://localhost:5601

# =============================================================================
# TLS/SSL Configuration
# =============================================================================
TLS_CERT_PATH=./.certs/cert.pem
TLS_KEY_PATH=./.certs/key.pem
TLS_CA_PATH=./.certs/rootCA.pem

# Service-to-service authentication (gamelogic <-> databank)
SERVICE_SECRET=your-64-char-hex-secret-here-generate-with-openssl-rand-hex-32

# =============================================================================
# Monitoring Stack (Prometheus & Grafana)
# =============================================================================
# Prometheus - metrics collection
PROMETHEUS_PORT=9090

# Grafana - visualization dashboards
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change-me
GRAFANA_ROOT_URL=http://localhost:3001

# Node Exporter - system metrics
NODE_EXPORTER_PORT=9100

# cAdvisor - container metrics  
CADVISOR_PORT=8080
